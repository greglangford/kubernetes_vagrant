[Unit]
Description=etcd
Requires=docker.service
After=docker.service

[Service]
ExecStartPre=-/usr/bin/docker kill %p
ExecStartPre=-/usr/bin/docker rm %p
ExecStartPre=-/usr/bin/docker pull {{ etcd_docker_image }}
ExecStart=/usr/bin/docker run --network=host --name %p {{ etcd_docker_image }} \
  etcd \
  --data-dir={{ etcd_data_directory }} \
  --listen-client-urls=http://127.0.0.1:2379 \
  --listen-peer-urls=http://127.0.0.1:2380 \
  --advertise-client-urls=http://127.0.0.1:2379

[Install]
WantedBy=multi-user.target
